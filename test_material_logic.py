#!/usr/bin/env python3
"""
–¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–≥–∏–∫–∏ —Å–ø–∏—Å–∞–Ω–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
"""

from database import Database

def test_material_logic():
    """–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Å–ø–∏—Å–∞–Ω–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤"""
    
    db = Database()
    
    print("=" * 70)
    print("  –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –õ–û–ì–ò–ö–ò –°–ü–ò–°–ê–ù–ò–Ø –ú–ê–¢–ï–†–ò–ê–õ–û–í")
    print("=" * 70)
    print()
    
    # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
    employees = db.get_all_employees()
    
    if not employees:
        print("‚ùå –í –±–∞–∑–µ –Ω–µ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤!")
        print("   –î–æ–±–∞–≤—å—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —á–µ—Ä–µ–∑ –±–æ—Ç–∞:")
        print("   –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏ ‚Üí –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞")
        return
    
    print("üìã –°–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤:")
    print()
    for emp in employees:
        fiber = emp.get('fiber_balance', 0) or 0
        twisted = emp.get('twisted_pair_balance', 0) or 0
        print(f"  ‚Ä¢ {emp['full_name']} (ID: {emp['id']})")
        print(f"    –í–û–õ–°: {fiber} –º")
        print(f"    –í–∏—Ç–∞—è –ø–∞—Ä–∞: {twisted} –º")
        print()
    
    print("=" * 70)
    print("  –¢–ï–°–¢–û–í–´–ï –°–¶–ï–ù–ê–†–ò–ò")
    print("=" * 70)
    print()
    
    # –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–æ–≤
    print("–¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–æ–≤")
    print("-" * 70)
    
    if len(employees) >= 2:
        emp1 = employees[0]
        emp2 = employees[1]
        
        fiber1 = emp1.get('fiber_balance', 0) or 0
        twisted1 = emp1.get('twisted_pair_balance', 0) or 0
        fiber2 = emp2.get('fiber_balance', 0) or 0
        twisted2 = emp2.get('twisted_pair_balance', 0) or 0
        
        print(f"–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å 1: {emp1['full_name']}")
        print(f"  –í–û–õ–°: {fiber1}–º, –í–∏—Ç–∞—è –ø–∞—Ä–∞: {twisted1}–º")
        print()
        print(f"–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å 2: {emp2['full_name']}")
        print(f"  –í–û–õ–°: {fiber2}–º, –í–∏—Ç–∞—è –ø–∞—Ä–∞: {twisted2}–º")
        print()
        
        # –°–∏–º—É–ª—è—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
        test_fiber = 100
        test_twisted = 50
        
        print(f"–¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:")
        print(f"  –í–û–õ–°: {test_fiber}–º, –í–∏—Ç–∞—è –ø–∞—Ä–∞: {test_twisted}–º")
        print()
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É –∫–æ–≥–æ –µ—Å—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
        emp1_has_enough = (fiber1 >= test_fiber and twisted1 >= test_twisted)
        emp2_has_enough = (fiber2 >= test_fiber and twisted2 >= test_twisted)
        
        print("–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:")
        print(f"  {emp1['full_name']}: {'‚úÖ –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ' if emp1_has_enough else '‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ'}")
        print(f"  {emp2['full_name']}: {'‚úÖ –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ' if emp2_has_enough else '‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ'}")
        print()
        
        if emp1_has_enough and emp2_has_enough:
            print("üí° –õ–æ–≥–∏–∫–∞ –±–æ—Ç–∞: –ü—Ä–µ–¥–ª–æ–∂–∏—Ç –≤—ã–±—Ä–∞—Ç—å –ø–ª–∞—Ç–µ–ª—å—â–∏–∫–∞")
        elif emp1_has_enough and not emp2_has_enough:
            print(f"üí° –õ–æ–≥–∏–∫–∞ –±–æ—Ç–∞: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–ø–∏—à–µ—Ç —Å {emp1['full_name']}")
        elif not emp1_has_enough and emp2_has_enough:
            print(f"üí° –õ–æ–≥–∏–∫–∞ –±–æ—Ç–∞: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–ø–∏—à–µ—Ç —Å {emp2['full_name']}")
        else:
            print("üí° –õ–æ–≥–∏–∫–∞ –±–æ—Ç–∞: –ë–ª–æ–∫–∏—Ä—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è")
        
        print()
        print("üìä –í –æ—Ç—á—ë—Ç–µ –±—É–¥–µ—Ç —É–∫–∞–∑–∞–Ω–æ (–¥–ª—è –∑–∞—Ä–ø–ª–∞—Ç—ã):")
        print(f"  {emp1['full_name']}: –í–û–õ–° {test_fiber/2}–º, –í–ü {test_twisted/2}–º")
        print(f"  {emp2['full_name']}: –í–û–õ–° {test_fiber/2}–º, –í–ü {test_twisted/2}–º")
        
    else:
        print("‚ö†Ô∏è  –î–ª—è —Ç–µ—Å—Ç–∞ –Ω—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 2 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞")
    
    print()
    print("=" * 70)
    print("  –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –î–õ–Ø –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø")
    print("=" * 70)
    print()
    print("1. –°–æ–∑–¥–∞–π—Ç–µ 2 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —á–µ—Ä–µ–∑ –±–æ—Ç–∞")
    print("2. –î–æ–±–∞–≤—å—Ç–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –æ–¥–Ω–æ–º—É –∏–ª–∏ –æ–±–æ–∏–º:")
    print("   –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏ ‚Üí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏")
    print("3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å –æ–±–æ–∏–º–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è–º–∏")
    print("4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–≥–∏–∫–∞ —Å–ø–∏—Å–∞–Ω–∏—è")
    print()
    print("–í–∞—Ä–∏–∞–Ω—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:")
    print("  ‚Ä¢ –£ –æ–¥–Ω–æ–≥–æ –µ—Å—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã, —É –¥—Ä—É–≥–æ–≥–æ –Ω–µ—Ç")
    print("  ‚Ä¢ –£ –æ–±–æ–∏—Ö –µ—Å—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã")
    print("  ‚Ä¢ –ù–∏ —É –∫–æ–≥–æ –Ω–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤")
    print()
    print("=" * 70)


if __name__ == "__main__":
    try:
        test_material_logic()
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        import traceback
        traceback.print_exc()

